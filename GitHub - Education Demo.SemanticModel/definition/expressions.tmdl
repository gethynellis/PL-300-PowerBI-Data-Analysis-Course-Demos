expression 'Errors in OfstedFact' =
		let
		Source = OfstedFact,
		  #"Detected Type Mismatches" = let
		    tableWithOnlyPrimitiveTypes = Table.SelectColumns(Source, Table.ColumnsOfType(Source, {type nullable number, type nullable text, type nullable logical, type nullable date, type nullable datetime, type nullable datetimezone, type nullable time, type nullable duration})),
		    recordTypeFields = Type.RecordFields(Type.TableRow(Value.Type(tableWithOnlyPrimitiveTypes))),
		    fieldNames = Record.FieldNames(recordTypeFields),
		    fieldTypes = List.Transform(Record.ToList(recordTypeFields), each [Type]),
		    pairs = List.Transform(List.Positions(fieldNames), (i) => {fieldNames{i}, (v) => if v = null or Value.Is(v, fieldTypes{i}) then v else error [Message = "The type of the value does not match the type of the column.", Detail = v], fieldTypes{i}})
		in
		    Table.TransformColumns(Source, pairs),
		  #"Added Index" = Table.AddIndexColumn(#"Detected Type Mismatches", "Row Number" ,1),
		  #"Kept Errors" = Table.SelectRowsWithErrors(#"Added Index", {"Web link", "URN", "LAESTAB", "School name", "Ofsted phase", "Admissions policy", "Sixth form", "Ofsted region", "Region", "Local authority", "Parliamentary constituency", "Multi-academy trust UID", "Multi-academy trust name", "Academy sponsor UID", "Academy sponsor name", "Postcode", "The income deprivation affecting children index (IDACI) quintile", "Total number of pupils", "Number of ungraded inspections since the last graded inspection", "Date of latest ungraded inspection", "Ungraded inspection publication date", "Did the latest ungraded inspection convert to a graded inspection?", "Ungraded inspection overall outcome", "Number of monitoring and urgent inspections since last graded inspection", "Inspection type", "Inspection type grouping", "Event type grouping", "Inspection start date", "Publication date", "Overall effectiveness", "Category of concern", "Quality of education", "Behaviour and attitudes", "Personal development", "Effectiveness of leadership and management", "Safeguarding is effective?", "Early years provision (where applicable)", "Sixth form provision (where applicable)", "Previous graded inspection number", "Previous inspection start date", "Previous publication date", "Does the previous graded inspection relate to the URN of the current school?", "URN at time of previous graded inspection", "LAESTAB at time of previous graded inspection", "School name at time of previous graded inspection", "School type at time of previous graded inspection", "Previous graded inspection overall effectiveness", "Previous category of concern", "Previous quality of education", "Previous behaviour and attitudes", "Previous personal development", "Previous effectiveness of leadership and management", "Previous safeguarding is effective?", "KeyTypeofEducation"}),
		  #"Reordered Columns" = Table.ReorderColumns(#"Kept Errors", {"Row Number", "Web link", "URN", "LAESTAB", "School name", "Ofsted phase", "Admissions policy", "Sixth form", "Ofsted region", "Region", "Local authority", "Parliamentary constituency", "Multi-academy trust UID", "Multi-academy trust name", "Academy sponsor UID", "Academy sponsor name", "Postcode", "The income deprivation affecting children index (IDACI) quintile", "Total number of pupils", "Number of ungraded inspections since the last graded inspection", "Date of latest ungraded inspection", "Ungraded inspection publication date", "Did the latest ungraded inspection convert to a graded inspection?", "Ungraded inspection overall outcome", "Number of monitoring and urgent inspections since last graded inspection", "Inspection type", "Inspection type grouping", "Event type grouping", "Inspection start date", "Publication date", "Overall effectiveness", "Category of concern", "Quality of education", "Behaviour and attitudes", "Personal development", "Effectiveness of leadership and management", "Safeguarding is effective?", "Early years provision (where applicable)", "Sixth form provision (where applicable)", "Previous graded inspection number", "Previous inspection start date", "Previous publication date", "Does the previous graded inspection relate to the URN of the current school?", "URN at time of previous graded inspection", "LAESTAB at time of previous graded inspection", "School name at time of previous graded inspection", "School type at time of previous graded inspection", "Previous graded inspection overall effectiveness", "Previous category of concern", "Previous quality of education", "Previous behaviour and attitudes", "Previous personal development", "Previous effectiveness of leadership and management", "Previous safeguarding is effective?", "KeyTypeofEducation"})
		in
		  #"Reordered Columns"
	lineageTag: 4445da09-e5c4-450b-852f-e8c51086fd14
	queryGroup: 'Query Errors - 11/12/2024 10:18:59'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression Management_information_-_state-funded_schools_-_latest_inspections_as_at_31_Oct_ =
		let
		    Source = Csv.Document(File.Contents("C:\Users\GethynEllis\Desktop\Management_information_-_state-funded_schools_-_latest_inspections_as_at_31_Oct_2024.csv"),[Delimiter=",", Columns=74, Encoding=1252, QuoteStyle=QuoteStyle.None]),
		    #"Promoted Headers" = Table.PromoteHeaders(Source, [PromoteAllScalars=true]),
		    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"Web link", type text}, {"URN", Int64.Type}, {"LAESTAB", Int64.Type}, {"School name", type text}, {"Ofsted phase", type text}, {"Type of education", type text}, {"School open date", type text}, {"Admissions policy", type text}, {"Sixth form", type text}, {"Designated religious character", type text}, {"Religious ethos", type text}, {"Faith grouping", type text}, {"Ofsted region", type text}, {"Region", type text}, {"Local authority", type text}, {"Parliamentary constituency", type text}, {"Multi-academy trust UID", type text}, {"Multi-academy trust name", type text}, {"Academy sponsor UID", type text}, {"Academy sponsor name", type text}, {"Postcode", type text}, {"The income deprivation affecting children index (IDACI) quintile", type text}, {"Total number of pupils", Int64.Type}, {"Statutory lowest age", Int64.Type}, {"Statutory highest age", Int64.Type}, {"Latest ungraded inspection number since last graded inspection", type text}, {"Does the ungraded inspection relate to the URN of the current school?", type text}, {"URN at time of the ungraded inspection", type text}, {"LAESTAB at time of the ungraded inspection", type text}, {"School name at time of the ungraded inspection", type text}, {"School type at time of the ungraded inspection", type text}, {"Number of ungraded inspections since the last graded inspection", type text}, {"Date of latest ungraded inspection", type text}, {"Ungraded inspection publication date", type text}, {"Did the latest ungraded inspection convert to a graded inspection?", type text}, {"Ungraded inspection overall outcome", type text}, {"Number of monitoring and urgent inspections since last graded inspection", type text}, {"Inspection number of latest graded inspection", type text}, {"Inspection type", type text}, {"Inspection type grouping", type text}, {"Event type grouping", type text}, {"Inspection start date", type date}, {"Publication date", type date}, {"Does the latest graded inspection relate to the URN of the current school?", type text}, {"URN at time of latest graded inspection", Int64.Type}, {"LAESTAB at time of latest graded inspection", Int64.Type}, {"School name at time of latest graded inspection", type text}, {"School type at time of latest graded inspection", type text}, {"Overall effectiveness", Int64.Type}, {"Category of concern", type text}, {"Quality of education", Int64.Type}, {"Behaviour and attitudes", Int64.Type}, {"Personal development", Int64.Type}, {"Effectiveness of leadership and management", Int64.Type}, {"Safeguarding is effective?", type text}, {"Early years provision (where applicable)", Int64.Type}, {"Sixth form provision (where applicable)", Int64.Type}, {"Previous graded inspection number", type text}, {"Previous inspection start date", type date}, {"Previous publication date", type date}, {"Does the previous graded inspection relate to the URN of the current school?", type text}, {"URN at time of previous graded inspection", Int64.Type}, {"LAESTAB at time of previous graded inspection", Int64.Type}, {"School name at time of previous graded inspection", type text}, {"School type at time of previous graded inspection", type text}, {"Previous graded inspection overall effectiveness", Int64.Type}, {"Previous category of concern", type text}, {"Previous quality of education", Int64.Type}, {"Previous behaviour and attitudes", Int64.Type}, {"Previous personal development", Int64.Type}, {"Previous effectiveness of leadership and management", Int64.Type}, {"Previous safeguarding is effective?", type text}, {"Previous early years provision (where applicable)", Int64.Type}, {"Previous sixth form provision (where applicable)", Int64.Type}})
		in
		    #"Changed Type"
	lineageTag: 9411481c-f270-4b0d-9b6b-0dba3a9aa0f7

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Management_information_-_state-funded_schools_-_latest_inspections_as_at_31_ (2)' =
		let
		    Source = Csv.Document(File.Contents("C:\Users\GethynEllis\Desktop\Management_information_-_state-funded_schools_-_latest_inspections_as_at_31_Oct_2024.csv"),[Delimiter=",", Columns=74, Encoding=1252, QuoteStyle=QuoteStyle.None]),
		    #"Promoted Headers" = Table.PromoteHeaders(Source, [PromoteAllScalars=true]),
		    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"Web link", type text}, {"URN", Int64.Type}, {"LAESTAB", Int64.Type}, {"School name", type text}, {"Ofsted phase", type text}, {"Type of education", type text}, {"School open date", type text}, {"Admissions policy", type text}, {"Sixth form", type text}, {"Designated religious character", type text}, {"Religious ethos", type text}, {"Faith grouping", type text}, {"Ofsted region", type text}, {"Region", type text}, {"Local authority", type text}, {"Parliamentary constituency", type text}, {"Multi-academy trust UID", type text}, {"Multi-academy trust name", type text}, {"Academy sponsor UID", type text}, {"Academy sponsor name", type text}, {"Postcode", type text}, {"The income deprivation affecting children index (IDACI) quintile", type text}, {"Total number of pupils", Int64.Type}, {"Statutory lowest age", Int64.Type}, {"Statutory highest age", Int64.Type}, {"Latest ungraded inspection number since last graded inspection", type text}, {"Does the ungraded inspection relate to the URN of the current school?", type text}, {"URN at time of the ungraded inspection", type text}, {"LAESTAB at time of the ungraded inspection", type text}, {"School name at time of the ungraded inspection", type text}, {"School type at time of the ungraded inspection", type text}, {"Number of ungraded inspections since the last graded inspection", type text}, {"Date of latest ungraded inspection", type text}, {"Ungraded inspection publication date", type text}, {"Did the latest ungraded inspection convert to a graded inspection?", type text}, {"Ungraded inspection overall outcome", type text}, {"Number of monitoring and urgent inspections since last graded inspection", type text}, {"Inspection number of latest graded inspection", type text}, {"Inspection type", type text}, {"Inspection type grouping", type text}, {"Event type grouping", type text}, {"Inspection start date", type date}, {"Publication date", type date}, {"Does the latest graded inspection relate to the URN of the current school?", type text}, {"URN at time of latest graded inspection", Int64.Type}, {"LAESTAB at time of latest graded inspection", Int64.Type}, {"School name at time of latest graded inspection", type text}, {"School type at time of latest graded inspection", type text}, {"Overall effectiveness", Int64.Type}, {"Category of concern", type text}, {"Quality of education", Int64.Type}, {"Behaviour and attitudes", Int64.Type}, {"Personal development", Int64.Type}, {"Effectiveness of leadership and management", Int64.Type}, {"Safeguarding is effective?", type text}, {"Early years provision (where applicable)", Int64.Type}, {"Sixth form provision (where applicable)", Int64.Type}, {"Previous graded inspection number", type text}, {"Previous inspection start date", type date}, {"Previous publication date", type date}, {"Does the previous graded inspection relate to the URN of the current school?", type text}, {"URN at time of previous graded inspection", Int64.Type}, {"LAESTAB at time of previous graded inspection", Int64.Type}, {"School name at time of previous graded inspection", type text}, {"School type at time of previous graded inspection", type text}, {"Previous graded inspection overall effectiveness", Int64.Type}, {"Previous category of concern", type text}, {"Previous quality of education", Int64.Type}, {"Previous behaviour and attitudes", Int64.Type}, {"Previous personal development", Int64.Type}, {"Previous effectiveness of leadership and management", Int64.Type}, {"Previous safeguarding is effective?", type text}, {"Previous early years provision (where applicable)", Int64.Type}, {"Previous sixth form provision (where applicable)", Int64.Type}})
		in
		    #"Changed Type"
	lineageTag: 6707356b-1acf-49eb-9343-cd71e6e0de71

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

